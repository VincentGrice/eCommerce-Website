{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Django</title>
    {% include 'base/css.html' %}
    {% block based_head %} {% endblock %}
  </head>
  <body>
          <!-- Name of company's brand -->
         {% include 'base/navbar.html' with brand_name="Love's Touch" %}
      <div class="container">
         {% block content %}{% endblock %}
      </div>



   
    {% include 'base/js.html' %}

    <script>
      $(document).ready(function(){
        var productForm = $('.form-product-ajax')

        productForm.submit(function(event){
          event.preventDefault();
          console.log("Form isnt sending")
          var thisForm       = $(this)
          var actionEndpoint = thisForm.attr("action");
          var httpMethond    =  thisForm.attr("method");
          var formData       = thisForm.serialize();

          $.ajax({
            url: actionEndpoint,
            method: httpMethond,
            data: formData,

            success: function(data){
              var submitSpan = thisForm.find(".submit-span")
              if (data.added){
                submitSpan.html("In cart<button type='submit' class='btn btn-link'>Remove</button>")
              }else {
                submitSpan.html("<button type='submit' class='btn btn-success'>Add to Cart</button>")
              }
              
            },
            error: function(errorData){
              console.log("error")
              console.log(errorData)
            }
          })

        })
      })

    </script>
  </body>
</html>